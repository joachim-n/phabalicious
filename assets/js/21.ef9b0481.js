(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{441:function(t,a,e){"use strict";e.r(a);var s=e(55),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"deploying-artifacts"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploying-artifacts"}},[t._v("#")]),t._v(" Deploying artifacts")]),t._v(" "),e("p",[t._v("If you want to deploy artifacts, phabalicious can help you here, currently there are two methods supported:")]),t._v(" "),e("ul",[e("li",[t._v("artifacts--git")]),t._v(" "),e("li",[t._v("artifacts--ftp")])]),t._v(" "),e("p",[t._v("Both methods create a new application from scratch and deploy all or parts of it to a ftp server or store the artifacts in a git repository. Both methods are using the same stage mechanisms as in "),e("code",[t._v("app:create")]),t._v(".")]),t._v(" "),e("p",[t._v("Both methods needs the global "),e("code",[t._v("repository")]),t._v("-config, so they can pull the app into a new temporary folder.")]),t._v(" "),e("h2",{attrs:{id:"artifacts-ftp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#artifacts-ftp"}},[t._v("#")]),t._v(" artifacts--ftp")]),t._v(" "),e("p",[t._v("ftp will create a new application in a temporary folder, install all needed dependencies, copies the data into a new temporary folder and run the deploy script of the host-config. After that is finished, phab will mirror all changed files via "),e("code",[t._v("lftp")]),t._v(" to the server. "),e("code",[t._v("lftp")]),t._v(" supports multiple protocols, not only ftp, but it needs to be installed on the machine running phab.")]),t._v(" "),e("p",[t._v("ftp-sync use the following stages:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("installCode")]),t._v(" will most of the time clone the source repository")]),t._v(" "),e("li",[e("code",[t._v("installDependencies")]),t._v(" will install all needed dependencies")]),t._v(" "),e("li",[e("code",[t._v("runActions")]),t._v(" will run all defined actions (see below)")]),t._v(" "),e("li",[e("code",[t._v("runDeployScript")]),t._v(" run the deploy-script of the host to apply some custom changes")]),t._v(" "),e("li",[e("code",[t._v("syncToFtp")]),t._v(" sync all changed files with the remote ftp server.")])]),t._v(" "),e("h3",{attrs:{id:"example-config"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-config"}},[t._v("#")]),t._v(" Example config")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hosts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ftp-artifacts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("needs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" git\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" composer\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" artifacts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("ftp\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" script\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("artifact")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" stephan\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("host")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sftp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//localhost\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("secret\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("rootFolder")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" /home/stephan/somewhere\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("actions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" copy\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("to")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" .\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" cp .env.example .env\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" delete\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .git/\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .fabfile\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .editorconfig\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .env.example\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .gitattributes\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .gitignore\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" composer.lock\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" composer.json\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose.yml\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ls "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("la\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" confirm\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("question")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Do you want to continue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("\n\n")])])]),e("p",[t._v("The default actions for the ftp-artifact-method will copy all files to the target repo and remove the "),e("code",[t._v(".git")]),t._v("-folder and the fabfile.")]),t._v(" "),e("h2",{attrs:{id:"artifacts-git"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#artifacts-git"}},[t._v("#")]),t._v(" artifacts--git")]),t._v(" "),e("p",[t._v("This method will create the artifact, pull the target repository, copy all necessary files over to the target repository, commit any changes to the target repository and push the changes again. A CI listening to commits can do the actual deployment")]),t._v(" "),e("p",[t._v("It is using the following stages:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("installCode")]),t._v(", creates a temporary folder and pulls the source repository. (only when "),e("code",[t._v("useLocalRepository")]),t._v(" is set to false)")]),t._v(" "),e("li",[e("code",[t._v("installDependencies")]),t._v(" to install the dependencies")]),t._v(" "),e("li",[e("code",[t._v("getSourceCommitInfo")]),t._v(" get the commit hash from the source repo.")]),t._v(" "),e("li",[e("code",[t._v("runActions")]),t._v(" will run all defined actions (see below)")]),t._v(" "),e("li",[e("code",[t._v("copyFilesToTargetDirectory")]),t._v(", copy specified "),e("code",[t._v("files")]),t._v(" to the target directory, removes all files listed in "),e("code",[t._v("excludeFiles.gitSync")])]),t._v(" "),e("li",[e("code",[t._v("runDeployScript")]),t._v(" run the deploy script of the host-config.")]),t._v(" "),e("li",[e("code",[t._v("pushToTargetRepository")]),t._v(" commit and push all changes, using the changelog as a commit-message")])]),t._v(" "),e("p",[t._v("If you run phabalicious as part of a CI-setup, it might make sense to set "),e("code",[t._v("useLocalRepository")]),t._v(" to true, as this will instruct phab to use the current folder as a base for the artifact and won't create a new application in another temporary folder.")]),t._v(" "),e("h3",{attrs:{id:"example-config-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#example-config-2"}},[t._v("#")]),t._v(" Example config")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hosts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("git-artifact")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" develop\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("needs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" git\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" composer\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" artifacts"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("git\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" script\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("artifact")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gitOptions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clone")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n          "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("depth 10\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("branch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" develop\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("baseBranch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" master\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("repository")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ssh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//somewhere/repository.git\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("useLocalRepository")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("false")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("actions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" copy\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*'")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("to")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" .\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" cp .env.example .env\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" delete\n          "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .env.example\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" composer.json\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" composer.lock\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose.yml\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("compose"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("mbb.yml\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" .projectCreated\n")])])]),e("p",[t._v("the default actions for the git-artifact-method will copy all files to the target repo and remove the fabfile.")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("property")]),t._v(" "),e("th",[t._v("default value")]),t._v(" "),e("th",[t._v("description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("artifact.branch")])]),t._v(" "),e("td",[e("code",[t._v("false")])]),t._v(" "),e("td",[t._v("if set to false, the name of the source-branch is used, otherwise the value")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("artifact.baseBranch")])]),t._v(" "),e("td",[e("code",[t._v("master")])]),t._v(" "),e("td",[t._v("If phabalicious needs to create a new branch, because it is missing from the target-repository, then start the branch from "),e("code",[t._v("masterBranch")])])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("artifact.repository")])]),t._v(" "),e("td"),t._v(" "),e("td",[t._v("The url to the target-repository")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("artifact.actions")])]),t._v(" "),e("td"),t._v(" "),e("td",[t._v("Actions to perform")])])])]),t._v(" "),e("p",[t._v("Phab will use a shallow clone for the target repository to keep resources low. If you need to use a deep copy for the target repository, you can adapt the gitOptions like:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("hosts:\n  git-artifacts:\n    artifact:\n      gitOptions:\n        clone: []\n")])])]),e("p",[t._v("If the target repository contains commits not added by the artifact deployment, a warning will be shown to the user, with a list of commits and changed files. The user can confirm that he wants to continue, or stop the execution.")]),t._v(" "),e("p",[t._v("You can force the artifact based deployment by adding the "),e("code",[t._v("--force")]),t._v("-option, or by setting the "),e("code",[t._v("PHABALICIOUS_FORCE_GIT_ARTIFACT_DEPLOYMENT")]),t._v(" environment variable to 1.")]),t._v(" "),e("h3",{attrs:{id:"artifacts-custom"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#artifacts-custom"}},[t._v("#")]),t._v(" artifacts--custom")]),t._v(" "),e("p",[t._v("@TODO")]),t._v(" "),e("h2",{attrs:{id:"available-actions"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#available-actions"}},[t._v("#")]),t._v(" Available actions")]),t._v(" "),e("p",[t._v("You can customize the list of actions be run when deploying an artifact. Here's a list of available actions")]),t._v(" "),e("h3",{attrs:{id:"copy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[t._v("#")]),t._v(" copy")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" copy\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("argumnents")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("from")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" file1\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" folder2\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" subfolder/file3\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("to")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" targetsubfolder\n")])])]),e("p",[t._v("This will copy the three mentioned files and folders into the subfolder "),e("code",[t._v("targetsubfolder")]),t._v(" of the target folder. Please be aware, that you might need to create subdirectories beforehand manually via the "),e("code",[t._v("script")]),t._v("-method. Also be aware that copy action deletes existing files and folders from target before doing the copy, if you want to combine files from multiple sources it is better to also use the "),e("code",[t._v("script")]),t._v("-method for that.")]),t._v(" "),e("h3",{attrs:{id:"delete"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#delete"}},[t._v("#")]),t._v(" delete")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" delete\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" file1\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" folder2\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" subfolder/file3\n")])])]),e("p",[t._v("This action will delete the list of files and folders in the target folder. Here you can clean up the target and get rid of unneeded files.")]),t._v(" "),e("h3",{attrs:{id:"exclude"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exclude"}},[t._v("#")]),t._v(" exclude")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" exclude\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" file1\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" folder2\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" subfolder/file3\n")])])]),e("p",[t._v("Similar to "),e("code",[t._v("delete")]),t._v(" this will exclude the list of file and folders from be transferred to the target. For "),e("code",[t._v("ftp")]),t._v(" the list of files get excluded from transferring, for "),e("code",[t._v("git")]),t._v(" they will get resetted from the target repository.")]),t._v(" "),e("h3",{attrs:{id:"confirm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#confirm"}},[t._v("#")]),t._v(" confirm")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" confirm\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("question")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Do you want to continue"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("?")]),t._v("\n")])])]),e("p",[t._v("This action comes handy when degugging the build process, as it will stop the execution and asks the user the questions and wait for "),e("code",[t._v("yes")]),t._v(" before continuing. Answering sth different will cancel the further execution.")]),t._v(" "),e("h3",{attrs:{id:"script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#script"}},[t._v("#")]),t._v(" script")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(' echo "Hello world"\n    '),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" cp .env.production .env\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" compile"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("vue\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" script\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" docker"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("image\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" node"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("script")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm install\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" npm run build\n")])])]),e("p",[t._v("The "),e("code",[t._v("script")]),t._v("-action will run the script from the arguments section line by line. You can use the usual replacement patterns as for other scripts. Most helpful are:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Pattern")]),t._v(" "),e("th",[t._v("Description")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[e("code",[t._v("%context.data.installDir%")])]),t._v(" "),e("td",[t._v("The installation dir, where the app got installed into")])]),t._v(" "),e("tr",[e("td",[e("code",[t._v("%context.data.targetDir%")])]),t._v(" "),e("td",[t._v("The targetdir, where the app got copied to, which gets committed or synced")])])])]),t._v(" "),e("p",[t._v("If "),e("code",[t._v("arguments")]),t._v(" contains a name, then this named script will be executed. It should be available under the global "),e("code",[t._v("scripts")]),t._v("-section or on the hosts' scripts section.")]),t._v(" "),e("p",[t._v("Since 3.7 phab supports executing a script in a different context. If you set "),e("code",[t._v("arguments.context")]),t._v(" to "),e("code",[t._v("docker-image")]),t._v(" the lines in "),e("code",[t._v("script")]),t._v(" will be executed in a docker-container started from the named docker-image provided via the "),e("code",[t._v("image")]),t._v("-argument.")]),t._v(" "),e("p",[t._v("Note, that the container will be removed after the script finishes. Also the current user and group will be used inside the container to reduce issues with permissions. The current host-directory is available at "),e("code",[t._v("/app")]),t._v(" inside the container. If you want to keep files after the script finishes, make sure they are inside "),e("code",[t._v("/app")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"message"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message"}},[t._v("#")]),t._v(" message")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" message\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("message")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Hello world"),e("span",{pre:!0,attrs:{class:"token tag"}},[t._v("!")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" (comment"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("note"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("warning"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("error"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("success)\n")])])]),e("p",[t._v("Prints out a message regardless of the log-level using symfony styles.")]),t._v(" "),e("h3",{attrs:{id:"log"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#log"}},[t._v("#")]),t._v(" log")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("action")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" log\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arguments")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("message")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Hello world"),e("span",{pre:!0,attrs:{class:"token tag"}},[t._v("!")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("severity")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" (debug"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("info"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("notice"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("warning"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("|")]),t._v("error)\n")])])]),e("p",[t._v("Logs a message, will be visible according to the verbosity-level and the used severity.")])])}),[],!1,null,null,null);a.default=n.exports}}]);